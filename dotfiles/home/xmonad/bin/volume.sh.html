<div id="background"></div>
<div id='container'>
  <div class='section'>
    <div class='docs'><h1>volume.sh</h1></div>
  </div>
  <div class='clearall'>
  <div class='section' id='section-0'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-0'>#</a>
      </div>
      <p>The <strong><code>xmonad/bin/volume.sh</code></strong> script reports the current volume for the
specified mixer control in a way friendly enough to include in a dzen bar.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-1'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-1'>#</a>
      </div>
      <p>This is the mixer control on which the script will report volume. Note that
this should be the same value used in the keybindings of your
<a href="#/home/xmonad/xmonad.hs">xmonad.hs</a> file to control the volume.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nv">mixer_control</span><span class="o">=</span><span class="s2">&quot;Master&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-2'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-2'>#</a>
      </div>
      <p>First, we ask amixer to report on the mixer control specified above. We pipe
that output to grep, searching for the line containing "Front Left:". Amixer
reports the volume for each channel independently rather than together, so we
grab only the left one with the implicit assumption that the left and right
channels are equal. Finally, we use awk to pull out the fifth argument in
that line, which is the volume percentage plus the percent symbol, surrounded
by square brackets (e.g. "[100%]").</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="nv">vol</span><span class="o">=</span><span class="sb">`</span>amixer get <span class="s2">&quot;${mixer_control}&quot;</span> | grep <span class="s2">&quot;Front Left:&quot;</span> | awk <span class="s1">&#39;{print $5}&#39;</span><span class="sb">`</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-3'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-3'>#</a>
      </div>
      <p>If the current volume is 0%, we might as well report it as "[Mute]".</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">if</span> <span class="o">[</span> <span class="nv">$vol</span> <span class="o">==</span> <span class="s2">&quot;0%&quot;</span> <span class="o">]</span>
<span class="k">then </span>
<span class="k">    </span><span class="nb">echo</span> <span class="s2">&quot;[Mute]&quot;</span></pre></div>
    </div>
  </div>
  <div class='clearall'></div>
  <div class='section' id='section-4'>
    <div class='docs'>
      <div class='octowrap'>
        <a class='octothorpe' href='#section-4'>#</a>
      </div>
      <p>Otherwise, we eliminate the square brackets provided from the output above
and echo out the result. The conky bar that utilizes this script simply
executes this file and and reports the outcome.</p>
    </div>
    <div class='code'>
      <div class="highlight"><pre><span class="k">else</span>
<span class="k">    </span><span class="nv">vol</span><span class="o">=</span><span class="k">${</span><span class="nv">vol</span><span class="p">/\[/</span><span class="k">}</span>
    <span class="nv">vol</span><span class="o">=</span><span class="k">${</span><span class="nv">vol</span><span class="p">/\]/</span><span class="k">}</span>
    <span class="nb">echo</span> <span class="nv">$vol</span>
<span class="k">fi</span>

</pre></div>
    </div>
  </div>
  <div class='clearall'></div>
</div>

